package io.github.aasaru.drools.DrivingSession
import io.github.aasaru.drools.domain.DriveTimeExceeded;
import io.github.aasaru.drools.domain.Week;
import io.github.aasaru.drools.domain.InvalidWeek;

import io.github.aasaru.drools.domain.Drive;
import java.time.LocalDate;

rule "Exceed max 9 hours driving time"
	dialect "java"
	when
		$week: Week( )
		$day: Day(totalDayliDrivingTime()>540, totalDayliDrivingTime()<=600)


	then
		System.out.println("Day exceeededs Daily Driving Time  " +  $day);
        modify($week){
        countDrivingTimeExceeded++;}

        System.out.println("CountExceeded= " + $week.countDrivingTimeExceeded);
end

rule "Max drive Exceeded a week "

    dialect "java"
    when
        $week: Week(countDrivingTimeExceeded>2)
        not(InvalidWeek(this.getWeek() == $week))
    then
        System.out.println("Invalid week");

        insert(new InvalidWeek($week));

end

rule "Invalid Drive More than 10 hours"

    dialect "java"
    when
        $day: Day(totalDayliDrivingTime()>600)
        $week: Week(dayList.contains($day))
        not(InvalidWeek(this.getWeek() == $week))


    then
         System.out.println("Invalid week, more than 10 hours in day " + $day);
         System.out.println("Dopo le 10 ore" + $week.countDrivingTimeExceeded);
         insert(new InvalidWeek($week));

end

rule "Max weekly Driving total time"
    dialect "java"
    when
        $week: Week(this.weeklyDrivingTime()>3360)
        not(InvalidWeek(this.getWeek() == $week))

    then
        System.out.println("Invalid Week, because the weekly driving time exceeds the 56 hours");
        insert (new InvalidWeek($week));

end

rule "Max driving session 4:30 hours"
    dialect "java"
    when
        $week: Week()

    then








